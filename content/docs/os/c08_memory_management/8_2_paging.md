---
title: "OS 8.02 - Paging"
description: ""
summary: ""
date: 2025-01-12T21:27:49+05:30
lastmod: 2025-01-12T21:27:49+05:30
draft: false
weight: 2046
toc: true
seo:
  title: "" # custom title (optional)
  description: "" # custom description (recommended)
  canonical: "" # custom canonical URL (optional)
  noindex: false # false (default) or true
---


 
#### 9.3 Paging

Another possible solution to the external-fragmentation problem is to permit the logical address space of processes to be noncontiguous, thus allowing a process to be allocated physical memory wherever such memory is available. This is the strategy used in paging, the most common memory-management
technique for computer systems.

paging, a memory-management scheme that permits a process’s physical address space to be non-contiguous. Paging avoids external fragmentation and the associated need for compaction, two problems that plague contiguous memory allocation. Because it offers numerous advantages, paging in its various forms is used in most operating systems, from those for large servers through those for mobile devices.
Paging is implemented through cooperation between the operating system and the computer hardware.

____

#### Basic Method of Paging

The basic method for implementing paging involves breaking physical memory into fixed-sized blocks called frames and breaking logical memory into blocks of the same size called pages. 

When a process is to be executed, its pages are loaded into any available memory frames from their source (a file system or the backing store). 

The backing store is divided into fixed-sized blocks that are the same size as the memory frames or clusters of multiple frames.


Every address generated by the CPU is divided into two parts: a page number (p) and a page offset (d):

The page number is used as an index into a per-process page table.

The page table contains the base address of each frame
in physical memory, and the offset is the location in the frame being referenced.

Thus, the base address of the frame is combined with the page offset to define the physical memory address.

{{< figure  src="images/os/8_10_PagingHardware-min.jpg"  alt="."  caption="." >}}

{{< figure  src="images/os/8_11_PagingModel-min.jpg"  alt="."  caption="." >}}



___

The page size (like the frame size) is defined by the hardware. The size of a page is a power of 2, typically varying between 4 KB and 1 GB per page, depending on the computer architecture

{{< figure  src="images/os/8_12_PagingExample-min.jpg"  alt="."  caption="." >}}

When we use a paging scheme, we have no external fragmentation: any free frame can be allocated to a process that needs it. However, we may have some internal fragmentation.

Today, pages are typically either 4 KB or 8 KB in size, and some systems support even larger page sizes.

`getconf PAGESIZE` for Unix `4096` which is 4kb

The first page of the process is loaded into one of the allocated frames, and the frame number is put in the page table for this process. The next page is loaded into another frame, its frame number is put into the page table, and so on



The programmer
views memory as one single space, containing only this one program. In fact,
the user program is scattered throughout physical memory, which also holds other programs.

user process by definition is unable to access memory it does
not own. It has no way of addressing memory outside of its page table, and the
table includes only those pages that the process owns.



allocation details of physical memory—which frames are allocated,
which frames are available, how many total frames there are, and so on. This information is generally kept in a single, system-wide data structure called a frame table. The frame table has one entry for each physical page frame, indicating whether the latter is free or allocated and, if it is allocated, to which page of which process (or processes).



The operating system maintains a copy of the page table for each process, just as it maintains a copy of the instruction counter and register contents. This copy is used to translate logical addresses to physical addresses whenever the operating system must map a logical address to a physical address manually.


_____


### Hardware Support

##### Translation Look-Aside Buffer


to access location i. We must first index into the page table, using the value to offset by the page number for i and combining with frame number. 
Then producing the actual address and accessing the desired place in memory.
This is two memory accesses for accessing the data.

The standard solution to this problem is to use a special, small, fast-lookup hardware cache called a translation look-aside buffer (TLB). The TLB is associative, high-speed memory. Each entry in the TLB consists of two parts: a key (or tag) and a value. When the associative memory is presented with an item, the item is compared with all keys simultaneously. If the item is found, the corresponding value field is returned. 

The search is fast; a TLB lookup in modern hardware is part of the instruction pipeline, essentially adding no performance penalty.


The TLB contains only a few of the page-table entries. When a logical address is generated by the CPU, the MMU first checks if its page number is present in the TLB. If the page number is found, its frame number is immediately available and is used to access memory.

If the page number is not in the TLB (known as a TLB miss), address
translation proceeds.


where a memory reference to the page table must be made. When the frame number is obtained to access memory. In addition, we add the page number and frame number to the TLB, so that they will be found quickly on the next reference.

{{< figure  src="images/os/8_14_PagingHardware-min.jpg"  alt="."  caption="." >}}


Some TLBs allow certain entries to be wired down, meaning that
they cannot be removed from the TLB. Typically, TLB entries for key kernel code are wired down.

____


The percentage of times that the page number of interest is found in the TLB is called the hit ratio. An 80-percent hit ratio, for example, means that we find the desired page number in the TLB 80 percent of the time.

___

#### Paging Memory Protection

Memory protection in a paged environment is accomplished by protection bits
associated with each frame. Normally, these bits are kept in the page table.


One additional bit is generally attached to each entry in the page table: a
valid –invalid bit. When this bit is set to valid, the associated page is in the
process’s logical address space and is thus a legal (or valid) page. When the
bit is set to invalid, the page is not in the process’s logical address space. Illegal
addresses are trapped by use of the valid –invalid bit. The operating system
sets this bit for each page to allow or disallow access to the page.


valid –invalid bit is set to invalid, and the computer will trap to the operating
system (invalid page reference).

___


#### 9.5 Swapping

Process instructions and the data they operate on must be in memory to be executed. However, a process, or a portion of a process, can be swapped
temporarily out of memory to a backing store and then brought back into memory for continued execution (Figure 9.19). Swapping makes it possible for the total physical address space of all processes to exceed the real physical memory of the system, thus increasing the degree of multiprogramming in a
system.




Most systems, including Linux and Windows, now use a variation of swap-
ping in which pages of a process—rather than an entire process—can be
swapped. This strategy still allows physical memory to be oversubscribed, but
does not incur the cost of swapping entire processes, as presumably only a
small number of pages will be involved in swapping



____


### Unit Summary

Memory is central to the operation of a modern computer system and
consists of a large array of bytes, each with its own address.

• One way to allocate an address space to each process is through the use of
base and limit registers. The base register holds the smallest legal physical
memory address, and the limit specifies the size of the range.


Binding symbolic address references to actual physical addresses may
occur during (1) compile, (2) load, or (3) execution time.
• An address generated by the CPU is known as a logical address, which
the memory management unit (MMU) translates to a physical address in
memory.
• One approach to allocating memory is to allocate partitions of contiguous
memory of varying sizes. These partitions may be allocated based on three
possible strategies: (1) first fit, (2) best fit, and (3) worst fit.
• Modern operating systems use paging to manage memory. In this process,
physical memory is divided into fixed-sized blocks called frames and
logical memory into blocks of the same size called pages.
• When paging is used, a logical address is divided into two parts: a page
number and a page offset. The page number serves as an index into a per-
process page table that contains the frame in physical memory that holds
the page. The offset is the specific location in the frame being referenced.
• A translation look-aside buffer (TLB) is a hardware cache of the page table.
Each TLB entry contains a page number and its corresponding frame.
• Using a TLB in address translation for paging systems involves obtaining
the page number from the logical address and checking if the frame for the
page is in the TLB. If it is, the frame is obtained from the TLB. If the frame
is not present in the TLB, it must be retrieved from the page table.

• Swapping allows the system to move pages belonging to a process to disk
to increase the degree of multiprogramming.

____


