<!doctype html>
<html lang="en" data-bs-theme="auto">
  <head><script src="/personal-site/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=personal-site/livereload" data-no-instant defer></script>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><link rel="preload" href="http://localhost:1313/personal-site/fonts/vendor/jost/jost-v4-latin-regular.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="http://localhost:1313/personal-site/fonts/vendor/jost/jost-v4-latin-500.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="http://localhost:1313/personal-site/fonts/vendor/jost/jost-v4-latin-700.woff2" as="font" type="font/woff2" crossorigin>
<script 
  src="/personal-site/js/color-mode.f14b3e296de1d0b69e75af684b62a4a912a2cadab04e36123407cd8388204f1d.js"
  integrity="sha256-8Us&#43;KW3h0Laeda9oS2KkqRKiytqwTjYSNAfNg4ggTx0=">
</script>


<link rel="stylesheet" href="/personal-site/main.c0e24d0bb4526375ef42a8fffa4eb23f8f782cb58ac9f07c6886fe943a0ed00e176b284d9d1a5b8e9d68a3f2f5918367e18fe55f5fde9451a8c6d3fe85342b7b.css" integrity="sha512-wOJNC7RSY3XvQqj/&#43;k6yP494LLWKyfB8aIb&#43;lDoO0A4XayhNnRpbjp1oo/L1kYNn4Y/lX1/elFGoxtP&#43;hTQrew==" crossorigin="anonymous">

<noscript><style>img.lazyload { display: none; }</style></noscript>
	
<title>SQL - 01 Relating</title>
  
<meta name="description" content="Reference site with summary on Programming Concepts">



</head>

  
  <body class="single section docs" data-bs-spy="scroll" data-bs-target="#toc" data-bs-root-margin="0px 0px -60%" data-bs-smooth-scroll="true" tabindex="0">
    <div class="sticky-top">
<header class="navbar navbar-expand-lg">
  <div class="container-lg">
  
    <a class="navbar-brand me-auto me-lg-3" href="/personal-site/">Sujith&#39;s Library</a>

    
    
    <button type="button" id="searchToggleMobile" class="btn btn-link nav-link mx-2 d-lg-none" aria-label="Search website">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <circle cx="10" cy="10" r="7"></circle>
        <line x1="21" y1="21" x2="15" y2="15"></line>
      </svg>
    </button>
    
    
    <button class="btn btn-link nav-link mx-2 order-3 d-lg-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavMain" aria-controls="offcanvasNavMain" aria-label="Open main navigation menu">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-menu" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <line x1="4" y1="8" x2="20" y2="8"></line>
        <line x1="4" y1="16" x2="20" y2="16"></line>
      </svg>
    </button>

    
    <div class="offcanvas offcanvas-end h-auto" tabindex="-1" id="offcanvasNavMain" aria-labelledby="offcanvasNavMainLabel">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="offcanvasNavMainLabel">Sujith&#39;s Library</h5>
        <button type="button" class="btn btn-link nav-link p-0 ms-auto" data-bs-dismiss="offcanvas" aria-label="Close">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
            <path d="M18 6l-12 12"></path>
            <path d="M6 6l12 12"></path>
         </svg>
        </button>
      </div>
      
      <div class="offcanvas-body d-flex flex-column flex-lg-row justify-content-between">
        <ul class="navbar-nav flex-grow-1"><li class="nav-item">
                <a class="nav-link" href="http://localhost:1313/personal-site/docs/python/">Python</a>
              </li>
            <li class="nav-item">
                <a class="nav-link" href="http://localhost:1313/personal-site/docs/html-css/">HTML/CSS</a>
              </li>
            <li class="nav-item">
                <a class="nav-link" href="http://localhost:1313/personal-site/docs/java-script/">JavaScript</a>
              </li>
            <li class="nav-item">
                <a class="nav-link" href="http://localhost:1313/personal-site/docs/java-script-dom/">JS DOM</a>
              </li>
            <li class="nav-item">
                <a class="nav-link" href="http://localhost:1313/personal-site/docs/c/">C &amp; DSA</a>
              </li>
            <li class="nav-item">
                <a class="nav-link" href="http://localhost:1313/personal-site/docs/bash-linux/">Linux</a>
              </li>
            <li class="nav-item">
                <a class="nav-link" href="http://localhost:1313/personal-site/docs/os/">OS</a>
              </li>
            <li class="nav-item">
                <a class="nav-link" href="http://localhost:1313/personal-site/docs/dbms/">DBMS</a>
              </li>
            <li class="nav-item">
                <a class="nav-link" href="http://localhost:1313/personal-site/docs/tools/">Tools</a>
              </li>
            <li class="nav-item">
                <a class="nav-link" href="http://localhost:1313/personal-site/blog/">Blog</a>
              </li>
            </ul>

        
        
        <button type="button" id="searchToggleDesktop" class="btn btn-link nav-link p-2 d-none d-lg-block" aria-label="Search website">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
            <circle cx="10" cy="10" r="7"></circle>
            <line x1="21" y1="21" x2="15" y2="15"></line>
          </svg>
        </button>
        
        
        
        <button id="buttonColorMode" class="btn btn-link mx-auto nav-link p-0 ms-lg-2 me-lg-1" type="button" aria-label="Toggle theme">
          <svg data-bs-theme-value="dark" xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-moon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
            <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
          </svg>
          <svg data-bs-theme-value="light" xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-sun" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
            <path d="M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0m-5 0h1m8 -9v1m8 8h1m-9 8v1m-6.4 -15.4l.7 .7m12.1 -.7l-.7 .7m0 11.4l.7 .7m-12.1 -.7l-.7 .7"></path>
          </svg>
        </button>
        
        <ul id="socialMenu" class="nav mx-auto flex-row order-lg-4">
          <li class="nav-item">
              <a class="nav-link social-link" href="https://github.com/sujith-eag"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5"></path></svg><small class="ms-2 visually-hidden">GitHub</small></a>
            </li>
          </ul>
        
        </div>
    </div>

    
    </div>
</header>
</div>

<div class="modal" id="searchModal" tabindex="-1" aria-labelledby="searchModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-fullscreen-md-down">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5 visually-hidden" id="searchModalLabel">Search</h1>
        <button type="button" class="btn-close visually-hidden" data-bs-dismiss="modal" aria-label="Close"></button>
        <div class="search-input flex-grow-1 d-none">
          <form id="search-form" class="search-form" action="#" method="post" accept-charset="UTF-8" role="search">
            <label for="query" class="visually-hidden">Search</label>
            <div class="d-flex">
              <input type="search" id="query" name="query" class="search-text form-control form-control-lg" placeholder="Search" aria-label="Search" maxlength="128" autocomplete="off">
              <button type="button" class="btn btn-link text-decoration-none px-0 ms-3 d-md-none" data-bs-dismiss="modal" aria-label="Close">Cancel</button>
            </div>
          </form>
        </div>
      </div>
      <div class="modal-body">
        <p class="search-loading status message d-none mt-3 text-center">Loading search indexâ€¦</p>
        <p class="search-no-recent message d-none mt-3 text-center">No recent searches</p>
        <p class="search-no-results message d-none mt-3 text-center">No results for "<strong><span class="query-no-results">Query here</span></strong>"</p>
        <div id="searchResults" class="search-results"></div>
        <template>
          <article class="search-result list-view">
            <div class="card my-3">
              <div class="card-body">
                <header>
                  <h2 class="h5 title title-submitted mb-0"><a class="stretched-link text-decoration-none text-reset" href="#">Title here</a></h2>
                  <div class="submitted d-none"><time class="created-date">Date here</time></div>
                </header>
                <div class="content">Summary here</div>
              </div>
            </div>
          </article>
        </template>
      </div>
      <div class="modal-footer">
        <ul class="list-inline me-auto d-none d-md-block">
          <li class="list-inline-item"><kbd class="me-2"><svg width="15" height="15" aria-label="Enter key" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M12 3.53088v3c0 1-1 2-2 2H4M7 11.53088l-3-3 3-3"></path></g></svg></kbd><span class="DocSearch-Label">to select</span></li>
          <li class="list-inline-item"><kbd class="me-2"><svg width="15" height="15" aria-label="Arrow down" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 3.5v8M10.5 8.5l-3 3-3-3"></path></g></svg></kbd><kbd class="me-2"><svg width="15" height="15" aria-label="Arrow up" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 11.5v-8M10.5 6.5l-3-3-3 3"></path></g></svg></kbd><span class="DocSearch-Label">to navigate</span></li>
          <li class="list-inline-item"><kbd class="me-2"><svg width="15" height="15" aria-label="Escape key" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M13.6167 8.936c-.1065.3583-.6883.962-1.4875.962-.7993 0-1.653-.9165-1.653-2.1258v-.5678c0-1.2548.7896-2.1016 1.653-2.1016.8634 0 1.3601.4778 1.4875 1.0724M9 6c-.1352-.4735-.7506-.9219-1.46-.8972-.7092.0246-1.344.57-1.344 1.2166s.4198.8812 1.3445.9805C8.465 7.3992 8.968 7.9337 9 8.5c.032.5663-.454 1.398-1.4595 1.398C6.6593 9.898 6 9 5.963 8.4851m-1.4748.5368c-.2635.5941-.8099.876-1.5443.876s-1.7073-.6248-1.7073-2.204v-.4603c0-1.0416.721-2.131 1.7073-2.131.9864 0 1.6425 1.031 1.5443 2.2492h-2.956"></path></g></svg></kbd><span class="DocSearch-Label">to close</span></li>
        </ul>
        <p class="d-md-none">Search by <a class="text-decoration-none" href="https://github.com/nextapps-de/flexsearch">FlexSearch</a></p>
      </div>
    </div>
  </div>
</div>


    <div class="wrap container-lg" role="document">
      <div class="content">
      
        
	<div class="row flex-xl-nowrap">
		
		<nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation">
			<div class="page-links">
  <h3>On this page</h3>
    <nav id="toc">
  <ul>
    <li><a href="#entity-relationship-diagram">Entity Relationship Diagram</a></li>
    <li><a href="#keys">Keys</a>
      <ul>
        <li><a href="#primary-keys">Primary Keys</a></li>
        <li><a href="#foreign-keys">Foreign Keys</a></li>
      </ul>
    </li>
    <li><a href="#subqueries">Subqueries</a>
      <ul>
        <li>
          <ul>
            <li><a href="#in">IN</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#join">JOIN</a></li>
    <li><a href="#sets">Sets</a>
      <ul>
        <li>
          <ul>
            <li></li>
            <li><a href="#intersect-1">INTERSECT</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#groups">Groups</a></li>
  </ul>
</nav>
</div>

		</nav>
		<main class="docs-content col-lg-11 col-xl-9">
		
			<h1>SQL - 01 Relating</h1>
			
			<nav class="toc-mobile d-xl-none" aria-label="Quaternary navigation">
				<details>
    <summary>On this page</summary>
    <div class="page-links">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#entity-relationship-diagram">Entity Relationship Diagram</a></li>
    <li><a href="#keys">Keys</a>
      <ul>
        <li><a href="#primary-keys">Primary Keys</a></li>
        <li><a href="#foreign-keys">Foreign Keys</a></li>
      </ul>
    </li>
    <li><a href="#subqueries">Subqueries</a>
      <ul>
        <li>
          <ul>
            <li><a href="#in">IN</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#join">JOIN</a></li>
    <li><a href="#sets">Sets</a>
      <ul>
        <li>
          <ul>
            <li></li>
            <li><a href="#intersect-1">INTERSECT</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#groups">Groups</a></li>
  </ul>
</nav>
    </div>
  </details>

			</nav>
			<p>Databases can have multiple tables.
<code>sqlite longlist.db</code>
<code>.tables</code> is command used to view all the tables in the database.</p>
<p>When there are some relationship between these tables, we call them <em><strong>relational database</strong></em>.
examples would be, Authors write books, publishers publish books, books are translated by translators.</p>
<p>The basic approach of organizing two or more tables can be using <em><strong>the honor system</strong></em> where the first row of one table will always correspond to the first row of another table. But there are possibility of mistakes in organizing it in this way.
<em><strong>One table approach</strong></em> could solve this but can lead to redundancy (duplication of data) if there are one to many relationship between columns.</p>
<h2 id="entity-relationship-diagram">Entity Relationship Diagram</h2>
<p>One to one (author writes a book)
One to many (author writes many books)
Many to many (few authors together wrote many books)
These can be visualized using an entity relationship (ER) diagram.</p>
<div class="mermaid text-center">erDiagram
    BOOK
    AUTHOR
    PUBLISHER
    TRANSLATOR
    RATING

    BOOK ||--o| AUTHOR : written_by
    BOOK ||--o| PUBLISHER : published_by
    BOOK ||--o| TRANSLATOR : translated_by
    BOOK ||--o| RATING : has_rating
    AUTHOR ||--o| AUTHOR : co_author_of
</div>

<div class="mermaid text-center">erDiagram
    BOOK
    AUTHOR
    PUBLISHER
    TRANSLATOR
    RATING

    BOOK }o--|| AUTHOR : written_by
    BOOK }o--|| PUBLISHER : published_by
    BOOK }o--o| TRANSLATOR : translated_by
    BOOK ||--o| RATING : has_rating
    AUTHOR ||--o| AUTHOR : co_author_of
</div>

<div class="mermaid text-center">erDiagram
    BOOK {
        string title
        string isbn
        string genre
        date publish_date
        int pages
    }
    AUTHOR {
        string first_name
        string last_name
        string birth_date
        string nationality
    }
    PUBLISHER {
        string name
        string address
        string contact_info
    }
    TRANSLATOR {
        string first_name
        string last_name
        string language
    }
    RATING {
        int rating_value
        string review
        date date_reviewed
    }

	BOOK }o--|| AUTHOR : written_by
    BOOK }o--|| PUBLISHER : published_by
    BOOK }o--o| TRANSLATOR : translated_by
    BOOK ||--o| RATING : has_rating
    AUTHOR ||--o| AUTHOR : co_author_of
</div>

<p>Each table is an entry in our database.
The relationship between the tables or entities are represented by the <strong>verbs</strong> that mark the lines connecting entries.</p>
<p>Crow&rsquo;s foot notation.
The first line with zero on the line indicates that there are no relations.
Second one means it should at least have one row that relates to it in the other table.
Third with many branches means that the entity is related to many rows from another table.</p>

<figure>
  <img
    srcset="data:image/webp;base64,UklGRioAAABXRUJQVlA4IB4AAAAwAQCdASoQAAkAAph8J6QAA3AA/vDbKcQGhV0AAAA="
        data-srcset="/personal-site/images/sql/1_relating/20241207072637_hu_8e43b2921c8d7d79.webp 480w,/personal-site/images/sql/1_relating/20241207072637_hu_fbe2f7e1000c289a.webp 576w,/personal-site/images/sql/1_relating/20241207072637_hu_6101765cfcd528f3.webp 768w,/personal-site/images/sql/1_relating/20241207072637_hu_87cbacffcb85438e.webp 1025w,/personal-site/images/sql/1_relating/20241207072637_hu_45ed02d86bc774ea.webp 1200w,/personal-site/images/sql/1_relating/20241207072637_hu_dd572c20f23731f6.webp 1440w,/personal-site/images/sql/1_relating/20241207072637_hu_d321c9316c0812b9.webp 5334w"
        data-sizes="auto"
    src="/personal-site/images/sql/1_relating/20241207072637_hu_cb997bee54cfede8.jpg"
    width="5334"
    height="3000"
    decoding="async"
    fetchpriority="auto"
    loading="lazy"
    alt="s"
    class="lazyload blur-up"
  ><figcaption>s</figcaption>
</figure>

<figure>
  <img
    srcset="data:image/webp;base64,UklGRigAAABXRUJQVlA4IBwAAAAwAQCdASoQAAkAAph8J6QAA3AA/vDGMbg8AAAA"
        data-srcset="/personal-site/images/sql/1_relating/20241207073647_hu_8fb4a96b0e20a4bc.webp 480w,/personal-site/images/sql/1_relating/20241207073647_hu_e0244474f51b8d1.webp 576w,/personal-site/images/sql/1_relating/20241207073647_hu_df6d849894ae5757.webp 768w,/personal-site/images/sql/1_relating/20241207073647_hu_86b651eb6628e1d1.webp 1025w,/personal-site/images/sql/1_relating/20241207073647_hu_99340fc9fc65f220.webp 1200w,/personal-site/images/sql/1_relating/20241207073647_hu_307549633a8359a3.webp 1440w,/personal-site/images/sql/1_relating/20241207073647_hu_24e87edcf40cdba0.webp 5334w"
        data-sizes="auto"
    src="/personal-site/images/sql/1_relating/20241207073647_hu_c5e718d1f7840bd3.jpg"
    width="5334"
    height="3000"
    decoding="async"
    fetchpriority="auto"
    loading="lazy"
    alt="s"
    class="lazyload blur-up"
  ><figcaption>s</figcaption>
</figure>
<p>One book is written by one author, also one author writes one book.</p>
<p>The author writes at least one book and a book is at least written by one author. The author could be associated with one or multiple books same for books.</p>
<p>
<figure>
  <img
    srcset="data:image/webp;base64,UklGRiwAAABXRUJQVlA4ICAAAACwAQCdASoQAAkAAph8J6QAAudc4/AAAP7ymEAqQAAAAA=="
        data-srcset="/personal-site/images/sql/1_relating/20241207074002_hu_f97b295cf091afa1.webp 480w,/personal-site/images/sql/1_relating/20241207074002_hu_8c1774203a3d562e.webp 576w,/personal-site/images/sql/1_relating/20241207074002_hu_6ecb20275f2cf6b6.webp 768w,/personal-site/images/sql/1_relating/20241207074002_hu_ed91ad2d96a70d59.webp 1025w,/personal-site/images/sql/1_relating/20241207074002_hu_eade5beaf88362f0.webp 1200w,/personal-site/images/sql/1_relating/20241207074002_hu_d9b1d18db635b696.webp 1440w,/personal-site/images/sql/1_relating/20241207074002_hu_bb68581bfeb23e97.webp 5334w"
        data-sizes="auto"
    src="/personal-site/images/sql/1_relating/20241207074002_hu_cd5eeb06dc853d83.jpg"
    width="5334"
    height="3000"
    decoding="async"
    fetchpriority="auto"
    loading="lazy"
    alt="s"
    class="lazyload blur-up"
  ><figcaption>s</figcaption>
</figure>
For a translator, books do not need to have a translator so they could have zero or many translators so can be represented by the zero.</p>
<hr>
<h2 id="keys">Keys</h2>
<p>To relate tables to one another.</p>
<h3 id="primary-keys">Primary Keys</h3>
<p>ISBN is a unique identifier given to all books to make it easy to search and identify.
Similarly, Primary key (like ISBN) is an identifier that is unique for every item in the table.
Each ID given within different tables (authors, books, publishers) would be the primary key of the table it belongs to.</p>
<h3 id="foreign-keys">Foreign Keys</h3>
<p>A foreign key is a primary key taken from a different table. By referencing the primary key of a different table, it helps relate the tables by forming a link between them.

<figure>
  <img
    srcset="data:image/webp;base64,UklGRjQAAABXRUJQVlA4ICgAAAAwAQCdASoQAAkAAph8J6QAA3AA/vCI/5fxl5ReinSbHJctA3AwAAAA"
        data-srcset="/personal-site/images/sql/1_relating/20241207074848_hu_d215a0a9af7e4d3a.webp 480w,/personal-site/images/sql/1_relating/20241207074848_hu_f388c4406d51d53d.webp 576w,/personal-site/images/sql/1_relating/20241207074848_hu_5536663e7d49791d.webp 768w,/personal-site/images/sql/1_relating/20241207074848_hu_ef1662d6a06c0a1d.webp 1025w,/personal-site/images/sql/1_relating/20241207074848_hu_8ef72ccc47d05cc2.webp 1200w,/personal-site/images/sql/1_relating/20241207074848_hu_4bad29850996d86a.webp 1440w,/personal-site/images/sql/1_relating/20241207074848_hu_7c4af20657de2809.webp 5334w"
        data-sizes="auto"
    src="/personal-site/images/sql/1_relating/20241207074848_hu_a14e9a9e9c5c57c5.jpg"
    width="5334"
    height="3000"
    decoding="async"
    fetchpriority="auto"
    loading="lazy"
    alt="s"
    class="lazyload blur-up"
  ><figcaption>s</figcaption>
</figure></p>
<p>Representing the many to many relationship using foreign keys in <code>authored</code> table that maps the primary keys of <code>books (book_id)</code> to the primary key of  <code>authors (author_id)</code></p>
<p>The tables like <code>authored</code> are called joint or junction tables.</p>
<hr>
<h2 id="subqueries">Subqueries</h2>
<p>A subquery is a query inside another query. also called nested queries which allows for making the queries more dynamic when many id or names have to be accessed.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="s2">&#34;title&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;books&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="s2">&#34;publisher_id&#34;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">SELECT</span><span class="w"> </span><span class="s2">&#34;id&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;publishers&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">WHERE</span><span class="w"> </span><span class="s2">&#34;publisher&#34;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Fitzcarrlado Edition&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span></span></span></code></pre></div>
  </figure>
</div>
<p>In this one to many relationship where a publisher has many books.
To find the title of the books from a publisher, we need the publisher id. To get the publisher_id we have to search for matching name in publishers table.</p>
<p>The subquery in the parentheses will be run first, or the deepest one will be. The indentation is just a styling convention.</p>
<p>To find rating of a book <code>in memory of memory</code></p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="s2">&#34;rating&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;ratings&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="s2">&#34;book_id&#34;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">SELECT</span><span class="w"> </span><span class="s2">&#34;id&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;books&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">WHERE</span><span class="w"> </span><span class="s2">&#34;title&#34;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;In Memory of Memory&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span></span></span></code></pre></div>
  </figure>
</div>
<p>Averaging the ratings by putting the rating in average</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="k">AVG</span><span class="p">(</span><span class="s2">&#34;rating&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;ratings&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="s2">&#34;book_id&#34;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">SELECT</span><span class="w"> </span><span class="s2">&#34;id&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;books&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">WHERE</span><span class="w"> </span><span class="s2">&#34;title&#34;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;In Memory of Memory&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span></span></span></code></pre></div>
  </figure>
</div>
<p>For a many-to-many relationships where there is a join table which has just the ID, there will be many nested queries.
To find the author(s) of book Flights</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="s2">&#34;name&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;authors&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="s2">&#34;id&#34;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">SELECT</span><span class="w"> </span><span class="s2">&#34;author_id&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;authored&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">WHERE</span><span class="w"> </span><span class="s2">&#34;book_id&#34;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">SELECT</span><span class="w"> </span><span class="s2">&#34;id&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;books&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">WHERE</span><span class="w"> </span><span class="s2">&#34;title&#34;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Flights&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span></span></span></code></pre></div>
  </figure>
</div>
<h4 id="in">IN</h4>
<p>This is the keyword used to check whether the desired <code>value</code> in <code>in</code> a given <code>set of values</code>.
The relationship between the authors and books is many to many. This means there can be one or more authors for a book.
To find the names of all the books written by an author, we would use <code>IN</code> keyword.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="s2">&#34;title&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;books&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="s2">&#34;id&#34;</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">SELECT</span><span class="w"> </span><span class="s2">&#34;book_id&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;authored&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">WHERE</span><span class="w"> </span><span class="s2">&#34;author_id&#34;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">SELECT</span><span class="w"> </span><span class="s2">&#34;id&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;authors&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">WHERE</span><span class="w"> </span><span class="s2">&#34;name&#34;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Fernanda Melchor&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span></span></span></code></pre></div>
  </figure>
</div>
<p>Innermost query uses <code>=</code> because we want to find the author by his name.
<code>IN</code> is used as the <code>authored</code> table might give many <code>book_id</code> as a set.
So searching <code>In</code> that to find all the id if they are present in <code>books</code>.</p>
<hr>
<h2 id="join">JOIN</h2>
<p>This allows to combine two or more tables together.</p>
<p>We can join the tables using a common factor between the two tables (like id) to ensure correct rows are lined up against each other.</p>

<figure>
  <img
    srcset="data:image/webp;base64,UklGRjIAAABXRUJQVlA4ICYAAABwAQCdASoQAAkAAph8J6WHgAGIAAD&#43;8IyGVqzqOgbbllEHylIAAA=="
        data-srcset="/personal-site/images/sql/1_relating/20241207081925_hu_262e2df89b812ae5.webp 480w,/personal-site/images/sql/1_relating/20241207081925_hu_b90ca3a28460034c.webp 576w,/personal-site/images/sql/1_relating/20241207081925_hu_129728159b87feed.webp 768w,/personal-site/images/sql/1_relating/20241207081925_hu_5636074de40f26f5.webp 1025w,/personal-site/images/sql/1_relating/20241207081925_hu_e7d33a7936599053.webp 1200w,/personal-site/images/sql/1_relating/20241207081925_hu_a496e47779730413.webp 1440w,/personal-site/images/sql/1_relating/20241207081925_hu_485013a6bb8ed433.webp 5334w"
        data-sizes="auto"
    src="/personal-site/images/sql/1_relating/20241207081925_hu_96a16ac26cc95537.jpg"
    width="5334"
    height="3000"
    decoding="async"
    fetchpriority="auto"
    loading="lazy"
    alt="s"
    class="lazyload blur-up"
  ><figcaption>s</figcaption>
</figure>
<p>To join these two tables:</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;sea_lions&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">JOIN</span><span class="w"> </span><span class="s2">&#34;migrations&#34;</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="s2">&#34;migrations&#34;</span><span class="p">.</span><span class="s2">&#34;id&#34;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&#34;sea_lions&#34;</span><span class="p">.</span><span class="s2">&#34;id&#34;</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>
<p>The <code>ON</code> keyword is used to specify which values match between the tables being joined. (there is no way to join tables without matching values).</p>
<p><em><strong>INNER JOIN</strong></em>
Inner join happens when there is an id in one table which isn&rsquo;t present in another table so these rows will get removed from the joined table.
Only the rows which have their id match will be present. like the example above where just the <code>JOIN</code>&hellip;<code>ON</code> is used is an inner join.</p>
<p><em><strong>OUTER JOIN</strong></em>
This allows for some data which doesn&rsquo;t match also to be kept. leading to <code>NULL</code> values when joined.</p>
<p><code>LEFT JOIN</code> prioritize the data in the left (first) table.(keeps all the rows from first table)
<code>RIGHT JOIN</code> prioritize the data in the right(second) table and keeps all rows of second table.
<code>FULL JOIN</code> allows to see the entries of all the tables.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;sea_lions&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">LEFT</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="s2">&#34;migrations&#34;</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="s2">&#34;migrations&#34;</span><span class="p">.</span><span class="s2">&#34;id&#34;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&#34;sea_lions&#34;</span><span class="p">.</span><span class="s2">&#34;id&#34;</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>
<p><code>NATURAL JOIN</code>
If the values on which we are joining the two tables have the same column name in both tables, we can omit the <code>ON</code> section.
This will be an <code>INNER JOIN</code> and also there will be no duplicate ID columns.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;sea_lions&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">NATURAL</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="s2">&#34;migrations&#34;</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>
<hr>
<h2 id="sets">Sets</h2>
<p>On running a query, the results we see are called <code>result set</code>, which is a kind of set in SQL.</p>
<h5 id="intersect">INTERSECT</h5>
<p>Intersection of two sets (author, translator) when a person is in both.
This can be done by using <code>INTERSECT</code> operations.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="s2">&#34;name&#34;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;translators&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">INTERSECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="s2">&#34;name&#34;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;authors&#34;</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>

<figure>
  <img
    srcset="data:image/webp;base64,UklGRlgAAABXRUJQVlA4IEwAAADQAQCdASoQAAkAAph8J6QAArOfl4SKAAD&#43;8aNsUpwkfhzvskw1sI1VxezoEIuZKiJxXKiaLDbYk2Cy3/sLunGfNXmQurPkEuUUAAAA"
        data-srcset="/personal-site/images/sql/1_relating/20241207095029_hu_4e3bf6318dbeac3d.webp 480w,/personal-site/images/sql/1_relating/20241207095029_hu_92c2c7a306e7df3e.webp 576w,/personal-site/images/sql/1_relating/20241207095029_hu_6f44810413ed948.webp 768w,/personal-site/images/sql/1_relating/20241207095029_hu_57b3b6df4e2c5708.webp 1025w,/personal-site/images/sql/1_relating/20241207095029_hu_6240a806a27f2ce4.webp 1200w,/personal-site/images/sql/1_relating/20241207095029_hu_37504569e2939817.webp 1440w,/personal-site/images/sql/1_relating/20241207095029_hu_d9e39df70f4995d1.webp 5334w"
        data-sizes="auto"
    src="/personal-site/images/sql/1_relating/20241207095029_hu_33e74d84aae7029b.jpg"
    width="5334"
    height="3000"
    decoding="async"
    fetchpriority="auto"
    loading="lazy"
    alt="s"
    class="lazyload blur-up"
  ><figcaption>s</figcaption>
</figure>
<h5 id="union">UNION</h5>
<p>If a person is either an author or translator or both, then they belong to the union of the two sets.
So every author and translator is included but only once in this result.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="s2">&#34;name&#34;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;translators&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">UNION</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="s2">&#34;name&#34;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;authors&#34;</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>

<figure>
  <img
    srcset="data:image/webp;base64,UklGRj4AAABXRUJQVlA4IDIAAACwAQCdASoQAAkAAph8J6gCw7DwqMCAAP7yspilOJuhfNtAGPPomIYuMnSpSMKxaOtEAA=="
        data-srcset="/personal-site/images/sql/1_relating/20241207095230_hu_321c146a014ac963.webp 480w,/personal-site/images/sql/1_relating/20241207095230_hu_86d0871cc6f1d9fd.webp 576w,/personal-site/images/sql/1_relating/20241207095230_hu_bf51117c329e8673.webp 768w,/personal-site/images/sql/1_relating/20241207095230_hu_c9a1ad7c1a56543d.webp 1025w,/personal-site/images/sql/1_relating/20241207095230_hu_3b959667b7139902.webp 1200w,/personal-site/images/sql/1_relating/20241207095230_hu_cae2f09d25572920.webp 1440w,/personal-site/images/sql/1_relating/20241207095230_hu_c7309ea7b1272736.webp 5334w"
        data-sizes="auto"
    src="/personal-site/images/sql/1_relating/20241207095230_hu_2f5cfb2bb9c3d0ba.jpg"
    width="5334"
    height="3000"
    decoding="async"
    fetchpriority="auto"
    loading="lazy"
    alt="s"
    class="lazyload blur-up"
  ><figcaption>s</figcaption>
</figure>
<p>To get profession of person in result,</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="s1">&#39;author&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s2">&#34;profession&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;name&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;authors&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">UNION</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="s1">&#39;translator&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s2">&#34;profession&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;name&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;translators&#34;</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>
<h5 id="except">EXCEPT</h5>
<p>Everyone who is only an author using <code>EXCEPT</code>.
Which means the set of translators is subtracted from authors.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="s2">&#34;name&#34;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;authors&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">EXCEPT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="s2">&#34;name&#34;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;translators&#34;</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>

<figure>
  <img
    srcset="data:image/webp;base64,UklGRlAAAABXRUJQVlA4IEQAAACQAQCdASoQAAkAAph8JwAAUmRrC0AA/vKyDyXtwO9sAQEIDiqS3jEQL4f2X2J6kzcJRwL93Kf0wIMMPwsvLfH/mgAAAA=="
        data-srcset="/personal-site/images/sql/1_relating/20241207095810_hu_56b5f7e0aca5f867.webp 480w,/personal-site/images/sql/1_relating/20241207095810_hu_7aa5633e5d8068a3.webp 576w,/personal-site/images/sql/1_relating/20241207095810_hu_9fe70e46ccf18b0b.webp 768w,/personal-site/images/sql/1_relating/20241207095810_hu_acc529b95defa76a.webp 1025w,/personal-site/images/sql/1_relating/20241207095810_hu_8e4d1b4fade330ad.webp 1200w,/personal-site/images/sql/1_relating/20241207095810_hu_d1287aaa52314c2f.webp 1440w,/personal-site/images/sql/1_relating/20241207095810_hu_ad9172124d5b0c7b.webp 5334w"
        data-sizes="auto"
    src="/personal-site/images/sql/1_relating/20241207095810_hu_9731e36868fb45b7.jpg"
    width="5334"
    height="3000"
    decoding="async"
    fetchpriority="auto"
    loading="lazy"
    alt="s"
    class="lazyload blur-up"
  ><figcaption>s</figcaption>
</figure>
<h4 id="intersect-1">INTERSECT</h4>
<p>To find people who are either authors or translators but not both.</p>

<figure>
  <img
    srcset="data:image/webp;base64,UklGRlAAAABXRUJQVlA4IEQAAADwAQCdASoQAAkAAph8J5gCw7D7AujTiAAA/vKyDyXtwO9sMa&#43;inBGlzSeAqItlseBRYwApq6h2Cy8t8gBAYN23a56wAA=="
        data-srcset="/personal-site/images/sql/1_relating/20241207100012_hu_aba547c5bb4a369.webp 480w,/personal-site/images/sql/1_relating/20241207100012_hu_e4507a6e04c08d22.webp 576w,/personal-site/images/sql/1_relating/20241207100012_hu_d1a5752c6ba549c5.webp 768w,/personal-site/images/sql/1_relating/20241207100012_hu_fb806634a9601051.webp 1025w,/personal-site/images/sql/1_relating/20241207100012_hu_b1fadffb6d546576.webp 1200w,/personal-site/images/sql/1_relating/20241207100012_hu_f515e8ecfa8b1ac6.webp 1440w,/personal-site/images/sql/1_relating/20241207100012_hu_299b49544ea031fc.webp 5334w"
        data-sizes="auto"
    src="/personal-site/images/sql/1_relating/20241207100012_hu_640352b6fd979a7a.jpg"
    width="5334"
    height="3000"
    decoding="async"
    fetchpriority="auto"
    loading="lazy"
    alt="s"
    class="lazyload blur-up"
  ><figcaption>s</figcaption>
</figure>
<p>These are useful to answer many different questions.
Each nested query finds the ID&rsquo;s of the books for one translator.
The <code>INTERSECT</code> is used to intersect the resulting two sets to give the books both have collaborated on.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="s2">&#34;books_id&#34;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;translated&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="s2">&#34;translator_id&#34;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">SELECT</span><span class="w"> </span><span class="s2">&#34;id&#34;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;translators&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">WHERE</span><span class="w"> </span><span class="s2">&#34;name&#34;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Sophie&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">INTERSECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="s2">&#34;books_id&#34;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;translated&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="s2">&#34;translator_id&#34;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">SELECT</span><span class="w"> </span><span class="s2">&#34;id&#34;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;translators&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">WHERE</span><span class="w"> </span><span class="s2">&#34;name&#34;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Margaret&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span></span></span></code></pre></div>
  </figure>
</div>
<p>We have to make sure to have same number and type of columns in the sets to be combined using <code>INTERSECT</code> <code>UNION</code> etc</p>
<h2 id="groups">Groups</h2>
<p>We want to find the average rating if the book.
First need the group ratings together by the book and then average the ratings out for each books(each group)</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="s2">&#34;book_id&#34;</span><span class="p">,</span><span class="w"> </span><span class="k">AVG</span><span class="p">(</span><span class="s2">&#34;rating&#34;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s2">&#34;average ratings&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;ratings&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s2">&#34;book_id&#34;</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>
<p>In this query, <code>GROUP By</code> was used to create groups for each book and then collapse the ratings of the group into an average rating!</p>
<p>To see the books that are rated with average rating of over 4.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="s2">&#34;book_id&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">ROUND</span><span class="p">(</span><span class="k">AVG</span><span class="p">(</span><span class="s2">&#34;rating&#34;</span><span class="p">),</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s2">&#34;average rating&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;ratings&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s2">&#34;book_id&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">HAVING</span><span class="w"> </span><span class="s2">&#34;average rating&#34;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">4</span><span class="p">.</span><span class="mi">0</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>
<p><code>HAVING</code> is used here to specify a condition for the groups, instead of <code>WHERE</code> (which specifies conditions for individual rows)</p>
<p>Ordering the books according the the rating</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="s2">&#34;book_id&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">ROUND</span><span class="p">(</span><span class="k">AVG</span><span class="p">(</span><span class="s2">&#34;rating&#34;</span><span class="p">),</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="s2">&#34;average rating&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;ratings&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s2">&#34;book_id&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">HAVING</span><span class="w"> </span><span class="s2">&#34;average rating&#34;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">4</span><span class="p">.</span><span class="mi">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">ORDERE</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s2">&#34;average rating&#34;</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>
<p>To get the number of rating for each book</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="s2">&#34;book_id&#34;</span><span class="p">,</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="s2">&#34;rating&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;ratings&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s2">&#34;book_id&#34;</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>

			<div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between">
				
				


  













<div class="edit-page">
  <a href="https://github.com/sujith-eag/personal-site/blob/main/content//docs/dbms/sql/1_relating.md">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2">
      <path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path>
    </svg>
    Edit this page on GitHub
  </a>
</div>

				</div>
			<div class="page-nav d-flex flex-column flex-sm-row">
	
	<div class="card w-100">
			<div class="card-body d-flex">
				<div class="d-flex flex-column justify-content-center">
					<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-arrow-left" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
						<path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
						<path d="M5 12l14 0"></path>
						<path d="M5 12l6 6"></path>
						<path d="M5 12l6 -6"></path>
				 	</svg>
				</div>
				<div class="d-flex flex-column">
					<div class="text-body-secondary">Prev</div>
					<a href="/personal-site/docs/dbms/sql/sql-0-quering/" class="stretched-link text-reset text-decoration-none">SQL - 0 Quering</a>
				</div>
			</div>
		</div>
	<div class="m-2"></div>
	<div class="card text-end w-100">
			<div class="card-body d-flex justify-content-end">
				<div class="d-flex flex-column">
					<div class="text-body-secondary">Next</div>
					<a href="/personal-site/docs/dbms/sql/sql-02-designing/" class="stretched-link text-reset text-decoration-none">SQL - 02 Designing</a>
				</div>
				<div class="d-flex flex-column justify-content-center">
					<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-arrow-right" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
						<path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
						<path d="M5 12l14 0"></path>
						<path d="M13 18l6 -6"></path>
						<path d="M13 6l6 6"></path>
					</svg>
				</div>
			</div>
		</div>
	</div>

			
		</main>
		
	</div>

      
      </div>
    </div>
    
    
    <footer class="footer text-muted">
  <div class="container-lg">
    <div class="row">
      <div class="col-lg-8 text-center text-lg-start">
        <ul class="list-inline">
          <li class="list-inline-item"><a class="text-muted" href="/personal-site/privacy/">Privacy Policy</a></li>
        </ul>
      </div>
      <div class="col-lg-8 text-center text-lg-end">
        <ul class="list-inline">
          <li class="list-inline-item">Made by <a class="text-muted" href="https://sujith-eag.github.io/personal-site/">Sujith</a></li>
        </ul>
      </div>
    </div>
  </div>
</footer>

    

<script async
  src="/personal-site/js/app.ec98ea736af7f8f531281a21224330da682d1dc9973423443b3d5ce8c45c6ea1.js"
  integrity="sha256-7Jjqc2r3&#43;PUxKBohIkMw2mgtHcmXNCNEOz1c6MRcbqE=">
</script>





<script async
  src="/personal-site/js/flexsearch.8350d2f520e131f8552ed57c1eadd05c50eccf0427267781442dd8ddf8fdcdf7.js"
  integrity="sha256-g1DS9SDhMfhVLtV8Hq3QXFDszwQnJneBRC3Y3fj9zfc=">
</script>
<script async
  src="/personal-site/js/search-modal.877cece5b6bc789456f89fa1955ccfcd8a5acdb2179e7882e292a6caa49efe68.js"
  integrity="sha256-h3zs5ba8eJRW&#43;J&#43;hlVzPzYpazbIXnniC4pKmyqSe/mg=">
</script>

    
  </body>
</html>