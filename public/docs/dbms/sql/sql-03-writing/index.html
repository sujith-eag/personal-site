<!doctype html>
<html lang="en" data-bs-theme="auto">
  <head><script src="/personal-site/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=personal-site/livereload" data-no-instant defer></script>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><link rel="preload" href="http://localhost:1313/personal-site/fonts/vendor/jost/jost-v4-latin-regular.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="http://localhost:1313/personal-site/fonts/vendor/jost/jost-v4-latin-500.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="http://localhost:1313/personal-site/fonts/vendor/jost/jost-v4-latin-700.woff2" as="font" type="font/woff2" crossorigin>
<script 
  src="/personal-site/js/color-mode.f14b3e296de1d0b69e75af684b62a4a912a2cadab04e36123407cd8388204f1d.js"
  integrity="sha256-8Us&#43;KW3h0Laeda9oS2KkqRKiytqwTjYSNAfNg4ggTx0=">
</script>


<link rel="stylesheet" href="/personal-site/main.c0e24d0bb4526375ef42a8fffa4eb23f8f782cb58ac9f07c6886fe943a0ed00e176b284d9d1a5b8e9d68a3f2f5918367e18fe55f5fde9451a8c6d3fe85342b7b.css" integrity="sha512-wOJNC7RSY3XvQqj/&#43;k6yP494LLWKyfB8aIb&#43;lDoO0A4XayhNnRpbjp1oo/L1kYNn4Y/lX1/elFGoxtP&#43;hTQrew==" crossorigin="anonymous">

<noscript><style>img.lazyload { display: none; }</style></noscript>
	
<title>SQL - 03 Writing</title>
  
<meta name="description" content="Reference site with summary on Programming Concepts">



</head>

  
  <body class="single section docs" data-bs-spy="scroll" data-bs-target="#toc" data-bs-root-margin="0px 0px -60%" data-bs-smooth-scroll="true" tabindex="0">
    <div class="sticky-top">
<header class="navbar navbar-expand-lg">
  <div class="container-lg">
  
    <a class="navbar-brand me-auto me-lg-3" href="/personal-site/">Sujith&#39;s Library</a>

    
    
    <button type="button" id="searchToggleMobile" class="btn btn-link nav-link mx-2 d-lg-none" aria-label="Search website">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <circle cx="10" cy="10" r="7"></circle>
        <line x1="21" y1="21" x2="15" y2="15"></line>
      </svg>
    </button>
    
    
    <button class="btn btn-link nav-link mx-2 order-3 d-lg-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavMain" aria-controls="offcanvasNavMain" aria-label="Open main navigation menu">
      <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-menu" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
        <line x1="4" y1="8" x2="20" y2="8"></line>
        <line x1="4" y1="16" x2="20" y2="16"></line>
      </svg>
    </button>

    
    <div class="offcanvas offcanvas-end h-auto" tabindex="-1" id="offcanvasNavMain" aria-labelledby="offcanvasNavMainLabel">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="offcanvasNavMainLabel">Sujith&#39;s Library</h5>
        <button type="button" class="btn btn-link nav-link p-0 ms-auto" data-bs-dismiss="offcanvas" aria-label="Close">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
            <path d="M18 6l-12 12"></path>
            <path d="M6 6l12 12"></path>
         </svg>
        </button>
      </div>
      
      <div class="offcanvas-body d-flex flex-column flex-lg-row justify-content-between">
        <ul class="navbar-nav flex-grow-1"><li class="nav-item">
                <a class="nav-link" href="http://localhost:1313/personal-site/docs/python/">Python</a>
              </li>
            <li class="nav-item">
                <a class="nav-link" href="http://localhost:1313/personal-site/docs/html-css/">HTML/CSS</a>
              </li>
            <li class="nav-item">
                <a class="nav-link" href="http://localhost:1313/personal-site/docs/java-script/">JavaScript</a>
              </li>
            <li class="nav-item">
                <a class="nav-link" href="http://localhost:1313/personal-site/docs/java-script-dom/">JS DOM</a>
              </li>
            <li class="nav-item">
                <a class="nav-link" href="http://localhost:1313/personal-site/docs/c/">C &amp; DSA</a>
              </li>
            <li class="nav-item">
                <a class="nav-link" href="http://localhost:1313/personal-site/docs/bash-linux/">Linux</a>
              </li>
            <li class="nav-item">
                <a class="nav-link" href="http://localhost:1313/personal-site/docs/os/">OS</a>
              </li>
            <li class="nav-item">
                <a class="nav-link" href="http://localhost:1313/personal-site/docs/dbms/">DBMS</a>
              </li>
            <li class="nav-item">
                <a class="nav-link" href="http://localhost:1313/personal-site/docs/tools/">Tools</a>
              </li>
            <li class="nav-item">
                <a class="nav-link" href="http://localhost:1313/personal-site/blog/">Blog</a>
              </li>
            </ul>

        
        
        <button type="button" id="searchToggleDesktop" class="btn btn-link nav-link p-2 d-none d-lg-block" aria-label="Search website">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
            <circle cx="10" cy="10" r="7"></circle>
            <line x1="21" y1="21" x2="15" y2="15"></line>
          </svg>
        </button>
        
        
        
        <button id="buttonColorMode" class="btn btn-link mx-auto nav-link p-0 ms-lg-2 me-lg-1" type="button" aria-label="Toggle theme">
          <svg data-bs-theme-value="dark" xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-moon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
            <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
          </svg>
          <svg data-bs-theme-value="light" xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-sun" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
            <path d="M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0m-5 0h1m8 -9v1m8 8h1m-9 8v1m-6.4 -15.4l.7 .7m12.1 -.7l-.7 .7m0 11.4l.7 .7m-12.1 -.7l-.7 .7"></path>
          </svg>
        </button>
        
        <ul id="socialMenu" class="nav mx-auto flex-row order-lg-4">
          <li class="nav-item">
              <a class="nav-link social-link" href="https://github.com/sujith-eag"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5"></path></svg><small class="ms-2 visually-hidden">GitHub</small></a>
            </li>
          </ul>
        
        </div>
    </div>

    
    </div>
</header>
</div>

<div class="modal" id="searchModal" tabindex="-1" aria-labelledby="searchModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-fullscreen-md-down">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5 visually-hidden" id="searchModalLabel">Search</h1>
        <button type="button" class="btn-close visually-hidden" data-bs-dismiss="modal" aria-label="Close"></button>
        <div class="search-input flex-grow-1 d-none">
          <form id="search-form" class="search-form" action="#" method="post" accept-charset="UTF-8" role="search">
            <label for="query" class="visually-hidden">Search</label>
            <div class="d-flex">
              <input type="search" id="query" name="query" class="search-text form-control form-control-lg" placeholder="Search" aria-label="Search" maxlength="128" autocomplete="off">
              <button type="button" class="btn btn-link text-decoration-none px-0 ms-3 d-md-none" data-bs-dismiss="modal" aria-label="Close">Cancel</button>
            </div>
          </form>
        </div>
      </div>
      <div class="modal-body">
        <p class="search-loading status message d-none mt-3 text-center">Loading search index…</p>
        <p class="search-no-recent message d-none mt-3 text-center">No recent searches</p>
        <p class="search-no-results message d-none mt-3 text-center">No results for "<strong><span class="query-no-results">Query here</span></strong>"</p>
        <div id="searchResults" class="search-results"></div>
        <template>
          <article class="search-result list-view">
            <div class="card my-3">
              <div class="card-body">
                <header>
                  <h2 class="h5 title title-submitted mb-0"><a class="stretched-link text-decoration-none text-reset" href="#">Title here</a></h2>
                  <div class="submitted d-none"><time class="created-date">Date here</time></div>
                </header>
                <div class="content">Summary here</div>
              </div>
            </div>
          </article>
        </template>
      </div>
      <div class="modal-footer">
        <ul class="list-inline me-auto d-none d-md-block">
          <li class="list-inline-item"><kbd class="me-2"><svg width="15" height="15" aria-label="Enter key" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M12 3.53088v3c0 1-1 2-2 2H4M7 11.53088l-3-3 3-3"></path></g></svg></kbd><span class="DocSearch-Label">to select</span></li>
          <li class="list-inline-item"><kbd class="me-2"><svg width="15" height="15" aria-label="Arrow down" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 3.5v8M10.5 8.5l-3 3-3-3"></path></g></svg></kbd><kbd class="me-2"><svg width="15" height="15" aria-label="Arrow up" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 11.5v-8M10.5 6.5l-3-3-3 3"></path></g></svg></kbd><span class="DocSearch-Label">to navigate</span></li>
          <li class="list-inline-item"><kbd class="me-2"><svg width="15" height="15" aria-label="Escape key" role="img"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M13.6167 8.936c-.1065.3583-.6883.962-1.4875.962-.7993 0-1.653-.9165-1.653-2.1258v-.5678c0-1.2548.7896-2.1016 1.653-2.1016.8634 0 1.3601.4778 1.4875 1.0724M9 6c-.1352-.4735-.7506-.9219-1.46-.8972-.7092.0246-1.344.57-1.344 1.2166s.4198.8812 1.3445.9805C8.465 7.3992 8.968 7.9337 9 8.5c.032.5663-.454 1.398-1.4595 1.398C6.6593 9.898 6 9 5.963 8.4851m-1.4748.5368c-.2635.5941-.8099.876-1.5443.876s-1.7073-.6248-1.7073-2.204v-.4603c0-1.0416.721-2.131 1.7073-2.131.9864 0 1.6425 1.031 1.5443 2.2492h-2.956"></path></g></svg></kbd><span class="DocSearch-Label">to close</span></li>
        </ul>
        <p class="d-md-none">Search by <a class="text-decoration-none" href="https://github.com/nextapps-de/flexsearch">FlexSearch</a></p>
      </div>
    </div>
  </div>
</div>


    <div class="wrap container-lg" role="document">
      <div class="content">
      
        
	<div class="row flex-xl-nowrap">
		
		<nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation">
			<div class="page-links">
  <h3>On this page</h3>
    <nav id="toc">
  <ul>
    <li>
      <ul>
        <li><a href="#inserting-data">Inserting Data</a></li>
        <li><a href="#inserting-multiple-rows">Inserting Multiple Rows</a></li>
        <li><a href="#using-a-csv-file">Using a CSV file</a></li>
      </ul>
    </li>
    <li><a href="#deleting-data">Deleting Data</a>
      <ul>
        <li>
          <ul>
            <li><a href="#foreign-key-constraints">Foreign Key Constraints</a></li>
          </ul>
        </li>
        <li><a href="#specifying-actions">Specifying actions</a></li>
      </ul>
    </li>
    <li><a href="#update">UPDATE</a>
      <ul>
        <li><a href="#cleaning-the-data">Cleaning the Data</a></li>
      </ul>
    </li>
    <li><a href="#triggers">Triggers</a>
      <ul>
        <li>
          <ul>
            <li><a href="#using-triggers">Using Triggers</a></li>
          </ul>
        </li>
        <li><a href="#soft-deletions">Soft Deletions</a></li>
      </ul>
    </li>
  </ul>
</nav>
</div>

		</nav>
		<main class="docs-content col-lg-11 col-xl-9">
		
			<h1>SQL - 03 Writing</h1>
			
			<nav class="toc-mobile d-xl-none" aria-label="Quaternary navigation">
				<details>
    <summary>On this page</summary>
    <div class="page-links">
      <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#inserting-data">Inserting Data</a></li>
        <li><a href="#inserting-multiple-rows">Inserting Multiple Rows</a></li>
        <li><a href="#using-a-csv-file">Using a CSV file</a></li>
      </ul>
    </li>
    <li><a href="#deleting-data">Deleting Data</a>
      <ul>
        <li>
          <ul>
            <li><a href="#foreign-key-constraints">Foreign Key Constraints</a></li>
          </ul>
        </li>
        <li><a href="#specifying-actions">Specifying actions</a></li>
      </ul>
    </li>
    <li><a href="#update">UPDATE</a>
      <ul>
        <li><a href="#cleaning-the-data">Cleaning the Data</a></li>
      </ul>
    </li>
    <li><a href="#triggers">Triggers</a>
      <ul>
        <li>
          <ul>
            <li><a href="#using-triggers">Using Triggers</a></li>
          </ul>
        </li>
        <li><a href="#soft-deletions">Soft Deletions</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
  </details>

			</nav>
			<h3 id="inserting-data">Inserting Data</h3>
<p><code>INSERT INTO</code> is used to insert a row of data into a given table.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="p">(</span><span class="n">column0</span><span class="p">,</span><span class="w"> </span><span class="p">...)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">VALUES</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="n">value0</span><span class="p">,</span><span class="w"> </span><span class="p">...);</span></span></span></code></pre></div>
  </figure>
</div>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="s2">&#34;collections&#34;</span><span class="w"> </span><span class="p">(</span><span class="s2">&#34;id&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;title&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;accession_number&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;acquired&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Profusion&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;56.257&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;1996-04-12&#39;</span><span class="p">);</span></span></span></code></pre></div>
  </figure>
</div>
<p>This command requires the list of columns in the table that will receive the values to be added to each column in the same order.</p>
<p>We can insert more rows by running the inserting multiple times, but typing out the primary key might result in error.
SQLite fills out the primary key automatically by checking for the highest value in id and incrementing it by one.
This can be done by leaving out the <code>id</code> column altogether while inserting the row.</p>
<p><em><strong>Other constraints</strong></em>
Cannot insert a similar <code>id</code> which is given <code>UNIQUE</code> constraint.
When there is <code>NOT NULL</code>, then <code>NULL</code> values cannot be added.</p>
<h3 id="inserting-multiple-rows">Inserting Multiple Rows</h3>
<p>INSERT INTO can be comma separated to insert multiple rows.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="p">(</span><span class="n">column0</span><span class="p">,</span><span class="w"> </span><span class="p">...)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">VALUES</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="n">value0</span><span class="p">,</span><span class="w"> </span><span class="p">...),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="n">value1</span><span class="p">,</span><span class="w"> </span><span class="p">...),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">...;</span></span></span></code></pre></div>
  </figure>
</div>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="s2">&#34;collections&#34;</span><span class="w"> </span><span class="p">(</span><span class="s2">&#34;title&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;accession_number&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;acquired&#34;</span><span class="p">)</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">VALUES</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="s1">&#39;Imaginative landscape&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;56.496&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="s1">&#39;Peonies and butterfly&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;06.1899&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;1906-01-01&#39;</span><span class="p">);</span></span></span></code></pre></div>
  </figure>
</div>
<p>The id is auto incremented so left out, the date is unknown so given as NULL.</p>
<h3 id="using-a-csv-file">Using a CSV file</h3>
<p>Data can be stored in a comma-separated-values format where values in each row are separated by a comma and rows are in in separate rows.</p>

<figure>
  <img
    srcset="data:image/webp;base64,UklGRi4AAABXRUJQVlA4ICIAAAAwAQCdASoQAAkAAph8J6QAA3AA/vC1Idni6mL5t4JwAAAA"
        data-srcset="/personal-site/images/sql/3_writing/20241212124154_hu_69300c8a37d43247.webp 480w,/personal-site/images/sql/3_writing/20241212124154_hu_8b589c8666bf0fb.webp 576w,/personal-site/images/sql/3_writing/20241212124154_hu_5d3d97a60f04d44d.webp 768w,/personal-site/images/sql/3_writing/20241212124154_hu_3e0d94ded0871cca.webp 1025w,/personal-site/images/sql/3_writing/20241212124154_hu_faca0f07c46bc4a6.webp 1200w,/personal-site/images/sql/3_writing/20241212124154_hu_eb261a496294b00d.webp 1440w,/personal-site/images/sql/3_writing/20241212124154_hu_2750730f7107105e.webp 1920w"
        data-sizes="auto"
    src="/personal-site/images/sql/3_writing/20241212124154_hu_ad128b7081270f38.jpg"
    width="1920"
    height="1080"
    decoding="async"
    fetchpriority="auto"
    loading="lazy"
    alt="s"
    class="lazyload blur-up"
  ><figcaption>s</figcaption>
</figure>
<p>This file can be imported into SQLite database.
<code>mfa.csv</code> is the file containing the data needed.
If the names of the column matches the names according to our schema in database.
We can import the CSV by running a SQLite command.
(A SQLite commands do not need &quot; &quot; )</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-SQL" data-lang="SQL"><span class="line"><span class="cl"><span class="p">.</span><span class="n">import</span><span class="w"> </span><span class="c1">--csv --skip 1 mfa.csv collections</span></span></span></code></pre></div>
  </figure>
</div>
<p><code>--csv</code> indicates we are importing CSV file (to specify they are comma separated)
<code>--skip 1</code> indicated that the first row needs to be skipped or not inserted into the table (as they are column headings which are already present in the table)
<code>mfa.csv colections</code>  the data from CSV file is copied into the table.</p>
<p>Most of the CSV files will not contain any primary key values like they were present here.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-csv" data-lang="csv"><span class="line"><span class="cl"><span class="s">title</span><span class="p">,</span><span class="s">accession_number</span><span class="p">,</span><span class="s">acquired</span><span class="p">
</span></span></span><span class="line"><span class="cl"><span class="p"></span><span class="s">Profusion of flowers</span><span class="p">,</span><span class="s">56.257</span><span class="p">,</span><span class="s">1956-04-12</span><span class="p">
</span></span></span><span class="line"><span class="cl"><span class="p"></span><span class="s">Farmers working at dawn</span><span class="p">,</span><span class="s">11.6152</span><span class="p">,</span><span class="s">1911-08-03</span><span class="p">
</span></span></span><span class="line"><span class="cl"><span class="p"></span><span class="s">Spring outing</span><span class="p">,</span><span class="s">14.76</span><span class="p">,</span><span class="s">1914-01-08</span><span class="p">
</span></span></span><span class="line"><span class="cl"><span class="p"></span><span class="s">Imaginative landscape</span><span class="p">,</span><span class="s">56.496</span><span class="p">,
</span></span></span><span class="line"><span class="cl"><span class="p"></span><span class="s">Peonies and butterfly</span><span class="p">,</span><span class="s">06.1899</span><span class="p">,</span><span class="s">1906-01-01</span></span></span></code></pre></div>
  </figure>
</div>
<p>First we will delete the data in the <code>collections</code> table
<code>DELETE FROM &quot;collections&quot;;</code>
By leaving out the row data in the end, it deletes all the rows in the table.</p>
<p>The schema has 4 rows and the CSV has 3 rows so we will have to use a temporary table first:</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="p">.</span><span class="n">import</span><span class="w"> </span><span class="c1">--csv mfa.csv temp</span></span></span></code></pre></div>
  </figure>
</div>
<p>Here skip is not used and SQLite will take the first row and convert those to column names of the new <code>temp</code> table.</p>
<p>Next we can select the data from <code>temp</code> without the primary key by a query and move it into <code>collections</code>. The id will be added automatically.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="s2">&#34;collections&#34;</span><span class="w"> </span><span class="p">(</span><span class="s2">&#34;title&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;accession_number&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;acquired&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="s2">&#34;title&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;accession_number&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;acquired&#34;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;temp&#34;</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>
<p>To clean up the data base we can drop the <code>temp</code> table
<code>DROP TABLE &quot;temp&quot;;</code></p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">table0</span><span class="w"> </span><span class="p">(</span><span class="n">column0</span><span class="p">,</span><span class="w"> </span><span class="p">...)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="n">column0</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">table1</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>
<p>Insert into the table 0 columns the result of the query of table 1.
The Columns have to allign.</p>
<h2 id="deleting-data">Deleting Data</h2>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">condition</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>
<p>Without the <code>condition</code> all rows will be deleted from the table.
<code>DELETE FROM table;</code></p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;collections&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="s2">&#34;title&#34;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Spring outing&#39;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;collections&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="s2">&#34;acquired&#34;</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>
<p>So sprint outing and the other one with acquired date NULL both will be deleted.</p>
<p>To delete the ones which are older than 1909</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;collections&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="s2">&#34;acquired&#34;</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="s1">&#39;1909-01-01&#39;</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>
<h4 id="foreign-key-constraints">Foreign Key Constraints</h4>
<p>Complications in deleting can impact the integrity of a database.
Foreign key constraints are a good example.
A foreign key column references the primary key of a different table. If we were to delete the primary key, the foreign key column would have nothing to reference!</p>

<figure>
  <img
    srcset="data:image/webp;base64,UklGRioAAABXRUJQVlA4IB4AAACQAQCdASoQAAkAAph8J6QAAudFrAAA/u/HkJvUAAA="
        data-srcset="/personal-site/images/sql/3_writing/20241212130723_hu_6766370c93884af6.webp 480w,/personal-site/images/sql/3_writing/20241212130723_hu_a29f75bed908bf1c.webp 576w,/personal-site/images/sql/3_writing/20241212130723_hu_fd5026d57d7ff0b5.webp 768w,/personal-site/images/sql/3_writing/20241212130723_hu_33ded4dcd1d2ea15.webp 1025w,/personal-site/images/sql/3_writing/20241212130723_hu_f43cfd24aad3fd1a.webp 1200w,/personal-site/images/sql/3_writing/20241212130723_hu_2112b4b33f320b68.webp 1440w,/personal-site/images/sql/3_writing/20241212130723_hu_40331b14409ceb95.webp 1920w"
        data-sizes="auto"
    src="/personal-site/images/sql/3_writing/20241212130723_hu_336363f9970887c2.jpg"
    width="1920"
    height="1080"
    decoding="async"
    fetchpriority="auto"
    loading="lazy"
    alt="s"
    class="lazyload blur-up"
  ><figcaption>s</figcaption>
</figure>

<figure>
  <img
    srcset="data:image/webp;base64,UklGRjAAAABXRUJQVlA4ICQAAAAwAQCdASoQAAkAAph8J6QAA3AA/vCI/5fxl50Qa97VuJAVAAA="
        data-srcset="/personal-site/images/sql/3_writing/20241212130734_hu_fcdf6ff05359c3b4.webp 480w,/personal-site/images/sql/3_writing/20241212130734_hu_822b93133c0dc376.webp 576w,/personal-site/images/sql/3_writing/20241212130734_hu_1e0cc37ba4d17a8f.webp 768w,/personal-site/images/sql/3_writing/20241212130734_hu_7449228985f87a51.webp 1025w,/personal-site/images/sql/3_writing/20241212130734_hu_2b17bfd847612410.webp 1200w,/personal-site/images/sql/3_writing/20241212130734_hu_fdc1334fff519bae.webp 1440w,/personal-site/images/sql/3_writing/20241212130734_hu_53b7840ac3175460.webp 1920w"
        data-sizes="auto"
    src="/personal-site/images/sql/3_writing/20241212130734_hu_d0fc0c0be27c593e.jpg"
    width="1920"
    height="1080"
    decoding="async"
    fetchpriority="auto"
    loading="lazy"
    alt="s"
    class="lazyload blur-up"
  ><figcaption>s</figcaption>
</figure>
<p>Here if we choose to delete the <code>Undefined artist</code> from the artists table, it will cause an error as the id of that is being refereed in the created table under <code>artist_id</code>.</p>
<p>One possibility is delete the corresponding <code>row</code> in created beforehand and then delete the one in the artists table.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;created&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="s2">&#34;artist_id&#34;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">SELECT</span><span class="w"> </span><span class="s2">&#34;id&#34;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;artists&#34;</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="s2">&#34;name&#34;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Undefined artist&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span></span></span></code></pre></div>
  </figure>
</div>
<p>Once the affiliation is deleted, the artist data can be deleted</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;artists&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="s2">&#34;name&#34;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Undefined artist&#39;</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>
<h3 id="specifying-actions">Specifying actions</h3>
<p>Another possibility of deleting an ID referred by a foreign key is deleted by using <code>ON DELETE</code> followed by <code>action</code> to be taken.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="s2">&#34;artist_id&#34;</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="s2">&#34;artists&#34;</span><span class="p">(</span><span class="s2">&#34;id&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="p">...</span></span></span></code></pre></div>
  </figure>
</div>
<p><code>ON DELETE RESTRICT</code>:
Restricts us from deleting IDs when the foreign key constraint is violated.</p>
<p><code>ON DELETE NO ACTION</code>:
Deletion of IDs that are referenced by a foreign key and nothing happens.</p>
<p><code>ON DELETE SET NULL</code>:
Deletion of IDs that are referenced by a foreign key and sets the foreign key reference to NULL</p>
<p><code>ON DELETE SET DEFAULT</code>:
does the same as the previous, but allows us to set a default value instead of <code>NULL</code>.</p>
<p><code>ON DELETE CASCADE</code>:
allows the deletion of IDs that are referenced by a foreign key and also proceeds to cascadingly delete the referencing foreign key rows.
For example, if we used this to delete an artist ID, all the artist’s affiliations with the artwork would also be deleted from the <code>created</code> table. (similar to previous two step approach)</p>
<p>Using these in the schema shows</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="s2">&#34;artist_id&#34;</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="s2">&#34;artists&#34;</span><span class="p">(</span><span class="s2">&#34;id&#34;</span><span class="p">)</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">CASCADE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="s2">&#34;collection_id&#34;</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="s2">&#34;collections&#34;</span><span class="p">(</span><span class="s2">&#34;id&#34;</span><span class="p">)</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">CASCADE</span></span></span></code></pre></div>
  </figure>
</div>
<p>The <code>ON DELETE CASCADE</code> will delete the rows it was referenced also when we run</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;artists&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="s2">&#34;name&#34;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Undefined artist&#39;</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>
<p>A deleted <code>ID</code> can be made to be repurposed for a new row, this can be done by using <code>AUTOINCREMENT</code> keyword while creating a column.</p>
<h2 id="update">UPDATE</h2>
<p>To change the data already in the table,</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="k">table</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SET</span><span class="w"> </span><span class="n">column0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value0</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">condition</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="s2">&#34;created&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SET</span><span class="w"> </span><span class="s2">&#34;artist_id&#34;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">SELECT</span><span class="w"> </span><span class="s2">&#34;id&#34;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;artists&#34;</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="s2">&#34;name&#34;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Li Yin&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="s2">&#34;collectio_id&#34;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">SELECT</span><span class="w"> </span><span class="s2">&#34;id&#34;</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;collections&#34;</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="s2">&#34;title&#34;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Farmers working at dawn&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span></span></span></code></pre></div>
  </figure>
</div>
<p>The value of <code>artist_id</code> is changed where the <code>collection_id</code> was of the given painting.</p>
<hr>
<h3 id="cleaning-the-data">Cleaning the Data</h3>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="s2">&#34;title&#34;</span><span class="p">,</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="s2">&#34;title&#34;</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;votes&#34;</span><span class="w"> </span><span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s2">&#34;title&#34;</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>
<p>To show the unique titles with their counts. (if the names match)</p>
<p>(SQLite Scalar functions to modify the data)</p>
<p><code>TRIM</code> to remove leading and trailing white space.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="s2">&#34;votes&#34;</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="s2">&#34;title&#34;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">trim</span><span class="p">(</span><span class="s2">&#34;title&#34;</span><span class="p">);</span></span></span></code></pre></div>
  </figure>
</div>
<p><code>UPPER</code> <code>LOWER</code> to change cases</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="s2">&#34;votes&#34;</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="s2">&#34;title&#34;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">upper</span><span class="p">(</span><span class="s2">&#34;title&#34;</span><span class="p">);</span></span></span></code></pre></div>
  </figure>
</div>
<p>Manually changing using conditions</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="s2">&#34;votes&#34;</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="s2">&#34;title&#34;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;FARMERS&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">WHERE</span><span class="w"> </span><span class="s2">&#34;title&#34;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;FAMER&#39;</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>
<p>Using the <code>LIKE</code> to update things that looks like a condition, not exactly <code>=</code> to.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="s2">&#34;votes&#34;</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="s2">&#34;title&#34;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;FARMERS&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">WHERE</span><span class="w"> </span><span class="s2">&#34;title&#34;</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;FA%&#39;</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>
<p>Like is case insensitive.</p>
<hr>
<h2 id="triggers">Triggers</h2>
<p>A SQL statement that runs when other statement is run like an Insert, Update, Delete.</p>
<p>Having a <code>collections</code> table and a <code>transactions</code> table.
Anything removed from collections appears as a sold item in transactions. Anything added will show up as purchases.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">CREATE</span><span class="w"> </span><span class="k">TRIGGER</span><span class="w"> </span><span class="n">name</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">BEFORE</span><span class="w"> </span><span class="k">INSERT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">table</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FOR</span><span class="w"> </span><span class="k">EACH</span><span class="w"> </span><span class="k">ROW</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">BEGIN</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="p">...:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">END</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>
<p>name is used to identify them, similar to a table name.
<code>AFTER</code> or <code>BEFORE</code> decides when should the statement run.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <pre tabindex="0"><code>BEFORE INSERT ON table
BEFORE DELETE ON table
BEFORE UPDATE OF column ON table</code></pre>
  </figure>
</div>
<p><code>FOR EACH ROW</code> specifies how many times a statement should be run, if two rows are deleted then it should run two times.</p>
<p>The statement or multiple statements that have to be run on a trigger will go between <code>BEGIN</code> and <code>END;</code></p>
<hr>
<h4 id="using-triggers">Using Triggers</h4>
<p>The current schema <code>.schema</code></p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="s2">&#34;collections&#34;</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="s2">&#34;id&#34;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="s2">&#34;title&#34;</span><span class="w"> </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="s2">&#34;accession_number&#34;</span><span class="w"> </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">UNIQUE</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="s2">&#34;acquired&#34;</span><span class="w"> </span><span class="nb">NUMERIC</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="s2">&#34;id&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="s2">&#34;artists&#34;</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="s2">&#34;id&#34;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="s2">&#34;name&#34;</span><span class="w"> </span><span class="nb">TEXT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="s2">&#34;id&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="s2">&#34;created&#34;</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="s2">&#34;artist_id&#34;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="s2">&#34;collection_id&#34;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="s2">&#34;artist_id&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;collection_id&#34;</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="s2">&#34;artist_id&#34;</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="s2">&#34;artists&#34;</span><span class="p">(</span><span class="s2">&#34;id&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">CASCADE</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="s2">&#34;collection_id&#34;</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="s2">&#34;collections&#34;</span><span class="p">(</span><span class="s2">&#34;id&#34;</span><span class="p">)</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">CASCADE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span></span></span></code></pre></div>
  </figure>
</div>
<p>Making the transactions table</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="s2">&#34;transactions&#34;</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="s2">&#34;id&#34;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="s2">&#34;title&#34;</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="s2">&#34;actions&#34;</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="s2">&#34;id&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">);</span></span></span></code></pre></div>
  </figure>
</div>
<p>Making a trigger, to run before deletion happens in <code>collections</code> table, to insert that data into <code>transactions</code> table.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">CREATE</span><span class="w"> </span><span class="k">TRIGGER</span><span class="w"> </span><span class="s2">&#34;sell&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">BEFORE</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="s2">&#34;collections&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FOR</span><span class="w"> </span><span class="k">EACH</span><span class="w"> </span><span class="k">ROW</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">BEGIN</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="s2">&#34;transactions&#34;</span><span class="p">(</span><span class="s2">&#34;title&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;action&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="k">OLD</span><span class="p">.</span><span class="s2">&#34;title&#34;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;sold&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">END</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>
<p>(This will become part of the schema.)
In Triggers there is access to the key words <code>OLD</code> and <code>NEW</code>.
<code>OLD</code> is the row we just deleted from. <code>OLD.&quot;title&quot;</code> gives access to the title of the row that was deleted.</p>
<p><code>NEW</code> is the recently added row.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">CREATE</span><span class="w"> </span><span class="k">TRIGGER</span><span class="w"> </span><span class="s2">&#34;buy&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">BEFORE</span><span class="w"> </span><span class="k">INSERT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="s2">&#34;collections&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FOR</span><span class="w"> </span><span class="k">EACH</span><span class="w"> </span><span class="k">ROW</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">BEGIN</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="s2">&#34;transactions&#34;</span><span class="p">(</span><span class="s2">&#34;title&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;action&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="k">NEW</span><span class="p">.</span><span class="s2">&#34;title&#34;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;bought&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">END</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>
<h3 id="soft-deletions">Soft Deletions</h3>
<p>Not completely dropping the row but having it in some other place,
Or another way is to just have a column which monitors if the row is deleted or not by using <code>0 1</code>
The filter can be done to show only those which are not having <code>1</code> at deleted.</p>
<p>Adding a new column, with default value 0</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="s2">&#34;collections&#34;</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="s2">&#34;deleted&#34;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>
<p>Now the value of deleted can be updated from 0 to 1.</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="s2">&#34;collections&#34;</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="s2">&#34;deleted&#34;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="s2">&#34;title&#34;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Farmers&#39;</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>
<p>To filter according to deleted</p>



<div class="expressive-code">
  <figure class="frame not-content">
  <figcaption class="header">
    <span class="title"></span>
  </figcaption>
  <div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;collections&#34;</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="s2">&#34;deleted&#34;</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="s2">&#34;collections&#34;</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="s2">&#34;deleted&#34;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span></span></span></code></pre></div>
  </figure>
</div>
<p>The advantage is data is not deleted, it can still be accessed but that has other issues when handling user data.</p>

			<div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between">
				
				


  













<div class="edit-page">
  <a href="https://github.com/sujith-eag/personal-site/blob/main/content//docs/dbms/sql/3_writing.md">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2">
      <path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path>
    </svg>
    Edit this page on GitHub
  </a>
</div>

				</div>
			<div class="page-nav d-flex flex-column flex-sm-row">
	
	<div class="card w-100">
			<div class="card-body d-flex">
				<div class="d-flex flex-column justify-content-center">
					<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-arrow-left" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
						<path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
						<path d="M5 12l14 0"></path>
						<path d="M5 12l6 6"></path>
						<path d="M5 12l6 -6"></path>
				 	</svg>
				</div>
				<div class="d-flex flex-column">
					<div class="text-body-secondary">Prev</div>
					<a href="/personal-site/docs/dbms/sql/sql-02-designing/" class="stretched-link text-reset text-decoration-none">SQL - 02 Designing</a>
				</div>
			</div>
		</div>
	<div class="m-2"></div>
	<div class="card text-end w-100">
			<div class="card-body d-flex justify-content-end">
				<div class="d-flex flex-column">
					<div class="text-body-secondary">Next</div>
					<a href="/personal-site/docs/dbms/sql/sql-04-viewing/" class="stretched-link text-reset text-decoration-none">SQL - 04 Viewing</a>
				</div>
				<div class="d-flex flex-column justify-content-center">
					<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-arrow-right" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
						<path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
						<path d="M5 12l14 0"></path>
						<path d="M13 18l6 -6"></path>
						<path d="M13 6l6 6"></path>
					</svg>
				</div>
			</div>
		</div>
	</div>

			
		</main>
		
	</div>

      
      </div>
    </div>
    
    
    <footer class="footer text-muted">
  <div class="container-lg">
    <div class="row">
      <div class="col-lg-8 text-center text-lg-start">
        <ul class="list-inline">
          <li class="list-inline-item"><a class="text-muted" href="/personal-site/privacy/">Privacy Policy</a></li>
        </ul>
      </div>
      <div class="col-lg-8 text-center text-lg-end">
        <ul class="list-inline">
          <li class="list-inline-item">Made by <a class="text-muted" href="https://sujith-eag.github.io/personal-site/">Sujith</a></li>
        </ul>
      </div>
    </div>
  </div>
</footer>

    

<script async
  src="/personal-site/js/app.ec98ea736af7f8f531281a21224330da682d1dc9973423443b3d5ce8c45c6ea1.js"
  integrity="sha256-7Jjqc2r3&#43;PUxKBohIkMw2mgtHcmXNCNEOz1c6MRcbqE=">
</script>





<script async
  src="/personal-site/js/flexsearch.8350d2f520e131f8552ed57c1eadd05c50eccf0427267781442dd8ddf8fdcdf7.js"
  integrity="sha256-g1DS9SDhMfhVLtV8Hq3QXFDszwQnJneBRC3Y3fj9zfc=">
</script>
<script async
  src="/personal-site/js/search-modal.877cece5b6bc789456f89fa1955ccfcd8a5acdb2179e7882e292a6caa49efe68.js"
  integrity="sha256-h3zs5ba8eJRW&#43;J&#43;hlVzPzYpazbIXnniC4pKmyqSe/mg=">
</script>

    
  </body>
</html>